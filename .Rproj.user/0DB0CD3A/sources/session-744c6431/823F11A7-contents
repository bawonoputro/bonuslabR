#' Predict method for ridgereg_qr objects
#'
#' Generate predictions from a fitted `ridgereg_qr` model.
#'
#' If `newdata` is not provided, this returns the fitted values on the
#' training data. If `newdata` is provided, it builds a model matrix using
#' the original model formula and returns predictions for those new rows.
#'
#' @param object A `ridgereg_qr` model object returned by [ridgereg_qr()].
#' @param newdata Optional data frame with new predictor values. If `NULL`,
#'   in-sample fitted values are returned.
#' @param ... Unused; included for S3 method compatibility.
#'
#' @return A numeric vector of predictions.
#'
#' @export
predict.ridgereg_qr <- function(object, newdata = NULL, ...) {
  # If no new data provided, just return fitted values from training set
  if (is.null(newdata)) {
    return(object$fitted.values)
  }

  # Build design matrix for new data using the original model formula
  X_new <- stats::model.matrix(object$formula, newdata)

  # Linear predictor: X_new %*% beta
  as.vector(X_new %*% object$coefficients)
}
